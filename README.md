# What is MinPlot?

Important: Please check the issues tab on the Minplot_V1.0 Github page for a changelog for current bugs and latest fixes. Users can also report bugs here or by emailing the author.

Information: MinPlot is a MATLAB®-based mineral formula recalculation and compositional plotting program for electron microprobe analyses (EPMA). The program offers recalculation and structural formula assignment for 15 different mineral groups: Garnet, pyroxene, olivine, amphibole, feldspar, mica, staurolite, cordierite, chlorite, chloritoid, talc, epidote, titanite, spinel, and sulfides. MinPlot is a fast and easy to use command line program and requires no prior computer programming knowledge. Percent mass fractions of oxides are loaded from datafiles and the user answers simple prompts to select mineral type, normalization scheme, and plotting options. Recalculated mineral formulas are automatically saved as output files and plots may be further manually customized by the user prior to saving. 

Loading and Saving Data: MinPlot reads data stored as text (.txt) files. The first line must contain oxide-based headers that are specific to the mineral formula to be recalculated (see Table 1 below). The headers must have capital and lowercase characters as shown in Table 1. For some phases, certain oxides are optional and will be calculated assuming a mass fraction of zero (W_j=0) if they are not included in the file read by MinPlot. MinPlot searches the header row for the column containing the appropriate header for each oxide, as a result the oxide data can be listed in any order in the input file. To start MinPlot, change the MATLAB® directory to the folder containing MinPlot and type the name of the program into the command window and hit ‘return’. When loading the data, the user is prompted to select the file in a pop-up window and, importantly, the file can be located in any folder on the user’s computer or in their network. Following calculation, the user is prompted to save their calculation. If yes, the data is automatically saved as tab delimited text files in the same directory as the source file, allowing for simplified data organization. 

Note - Example input files for all minerals are available on the MinPlot Github page.

<img width="758" alt="Table of Oxides" src="https://user-images.githubusercontent.com/87534196/232045945-2eefb1c0-4deb-4c94-b3e3-d6e24963030b.png">

# Mineral Plotting Options

Garnet supergroup: Garnet (X3Y2Z3O12) calculates with the following site assignments: X = Na, Ca, Ca, Mg, Mn, Fe2+, and Y at the dodecahedral site, Y = Mn, Mg, Fe2+, Fe3+, Cr, Ti, viAl, and Si at the octahedral site, Z = Fe3+, ivAl, and Si at the tetrahedral site, and O2 at the anion site. Garnet structural formula are calculated using normalization to 8 cations and 12 oxygens (for Fe3+-estimation), or 12 oxygen basis alone (for totalFe=Fe2+). Endmember fractions are calculated using the matrix inversion method for solving systems of linear equations. The garnet endmembers considered are almandine (Xalm), spessartine (Xsps), grossular (Xgrs), pyrope (Xprp), andradite (Xadr), and uvarovite (Xuv). Plotting options for garnet include the Xalm + Xsps, Xgrs, and Xprp ternary. A second Fe3+, Cr + Ti, and VIAl ternary diagram for substitutions at the octahedral site is also available.

<img width="500" alt="Garnet structural formula" src="https://user-images.githubusercontent.com/87534196/200539587-0a5b4360-f02f-4920-89a0-22ae3ba148d6.png">

New!! A specific formula recalculation and plotting option is available for grossular-andradite series garnets, such as those found in skarn deposits. The site assignment above is the same; however, the endmembers for Ti garnet endmemers schorlomite (Ca3Ti2(SiO4)(Fe3+O4)2) and morimotoite (Ca3(TiFe2+)(SiO4)3) are calculated. The procedure is as follows: First, the the schorlomite component is calculated as 1 - Si on the tetrahedral site, whereas all other garnet endmembers are considered to have Si on the tetrahdedral site (the combined endmember fraction equals Si). The morimotoite component on the octahedral site is calculated by (Ti + Fe2+ + Mg + Mn)/(2 - Fe3+ and Al on the tetrahedral site). The morimotite component therefore includes morimotoite-like substitutions (e.g., Ti4+ + Mg2+, Ti4+ + Mn2+) along with the strict morimotoite endmember (Fe2+ + Ti on the octahedral site). Andradite and Uvarovite are calculated by dividing octahedral Fe3+ and Cr, respectively, by (2 - Fe3+ and Al on the tetrahedral site). Finally, the Al fraction of the octahedral site is calcuated to determine the fraction of garnet wiith the formula X3Al2Si3O12. Almandine, grossular, pyrope, and spessartine components are then calculated by the fractions of Fe, Ca, Mg, and Mn on the dodecahedral site. The plot of octahedral Fe3+, Al, Ti for this scheme is an improvement over the regular scheme, but only gives meaningful differences for garnets from the grossular-andradite seires. 


Pyroxene: Pyroxene (M2M1T2O6) compositions are calculated following Morimoto et al. (1989), with K, Na, Ca, Fe2+, and Mg at the distorted octahedral M2 site, Fe2+, Mg, Mn, Cr, Fe3+, Ti, and viAl at the octahedral M1 site, and Fe3+, ivAl, and Si at the tetrahedral site. Normalization is to 4 cations and 6 oxygens in the Fe3+-estimation routine, and on a 6-oxygen basis for totalFe=Fe2+. Endmember fractions are calculated using the matrix inversion method for wollastonite (Xwo), ferrosillite (Xfs), enstatite (Xen), jadeite (Xjd), aegirine (Xaeg), and kosmochlore (Xkos).

<img width="500" alt="pyroxene structural formula" src="https://user-images.githubusercontent.com/87534196/200545156-541d84d0-1006-4928-85df-e16bf07e6770.png">

A second endmember calculation option is available following Harlow (1999) where endmembers are calculated as jadeite (Xjd), aegirine (Xaeg), diopside + hedenbergite (Xdi+hd), calcium-Tschermaks pyroxene (Xcats), kosmochlor (Xkos), K-kosmochlor (XK-kos), K-jadeite (XK-jd), calcium-Eskola pyroxene (Xcaes), and enstatite (Xen).

<img width="500" alt="pyroxene structural formula" src="https://user-images.githubusercontent.com/87534196/200545427-5df23652-d60a-4342-a3bc-584b9b8f5b02.png">

Plottinng and classification follows Morimoto et al. (1989), including the 'Q-J' diagram that distinguishes Ca-Mg-Fe pyroxenes (quad), Na-Ca pyroxenes (Na-Ca), and Na pyroxenes (Na), where J = 2Na is plotted on the x-axis and Q = Ca + Mg + Fe2+ on the y-axis. For Ca-rich pyroxenes, there is a Xwo, Xfs, and Xen ternary, whereas a Xquad, Xjd, and Xaeg ternary is available for Na-rich pyroxenes. Plots of XCa-es vs Xcats and XK-cpx (XK-cpx = XK-kos + XK-jd) vs XCa-es following Harlow (1999) is available. 

Olivine: Olivine (M2TO4) is calculated here with M = Ca, Mg, Mn, Fe2+, Ni, Cr, Fe3+. Ti, and viAl at the octahedral site, and T = Fe2+, ivAl, and Si at the tetrahedral site. Normalization is to 3 cations and 4 oxygens in the Fe3+ estimation routine, and on a 4-oxygen basis for totalFe = Fe2+. Endmember fractions if forsterite (Xfo), fayalite (Xfa), tephroite (Xte), and calcio-olivine (XCa-ol) are calculated using the matrix inversion method. Plotting optiions are for the forsterite-fayalite binary, Xfo, XCa-ol, and Xfa + Xte ternary, and Fo number vs NiO (Wt %). 

<img width="400" alt="olivine structural formula" src="https://user-images.githubusercontent.com/87534196/200578690-ccc6b75c-2889-4fd0-9822-248376a75076.png">

Clinoamphibole: Amphibole (AB2C5T8O22W2) compositions are calculated following the recommendations of Leake et al. (1997) and Hawthorne et al. (2012) for structural assignment, with A = □, K, Na, and Ca at the A site, B = Ca, Na, Mn, Fe2+, and Mg at the M4 site, C = Mn, Fe2+, Mg, Fe3+, Cr, Ti, and Al at the M1, M3, and M2 sites, T = Si and Ti at the T site, and OH-, F-, Cl-, and O2- at the W site. Ferric iron is estimated following Leake et al. (1997) and Hawthorne et al. (2012), see the manuscript for details. Amphibole classification plots for Ca, Na-Ca, and Na amphiboles follow the scheme of Hawthorne et al. (2012): Amphibole compositions are plotted as C(Al + Fe3+ + 2Ti) vs A(Na + K + 2Ca). MinPlot also includes plots of Fe3+/(Al + Fe3+ + Ti) vs Fe2+/(Fe2+ + Mg + Mn) for Na amphiboles and Si vs XMg for Ca amphiboles.

Endmember fractions are not done for amphibole given the large, complicated composition space. The composition space explored for Na, Na-Ca, and Ca amphiboles in the composition diagrams is expressed by the following formulae:

<img width="800" alt="Na-amphibole structural formula" src="https://user-images.githubusercontent.com/87534196/200581309-97fa8c89-2ace-4157-81ec-01672421462e.png">

<img width="800" alt="NaCa-amphibole structural formula" src="https://user-images.githubusercontent.com/87534196/200581489-d4858ea2-4c97-42e0-95c4-efcdafb79bbc.png">

<img width="800" alt="Ca-amphibole structural formula" src="https://user-images.githubusercontent.com/87534196/200581565-f742a83e-00ba-4c95-8ccb-3686b5bbd67a.png">

Feldspar: Feldspar (AT4O8) is calculated by normalizing to 8 oxygen equivalents, with A = Ca, Na, K, Ba, Fe2+, Mn, and Mg, and T = Al and Si. Endmembers are calculated for anorthite (Xan = Ca/(Ca + Na + K)), albite (Xab = Ca/(Ca + Na + K)), and alkali feldspar (Xor = K/(Ca + Na + K)). Plotting is available as the classic An-Ab-Or feldspar ternary. An option for the subdivisions is available. 

<img width="500" alt="feldspar structural formula" src="https://user-images.githubusercontent.com/87534196/200589611-8bfe2ecb-0b52-47da-ac68-837658a2fe3b.png">

Mica: Mica (IM2-3T4O10W2) is calculated normalizing to 11 oxygen equivalents. Ions are assigned as I = □, K, Na, Ca, and Ba, M = Mg, Mn, Fe2+, Cr, Ti, and VIAl, T = IVAl and Si, and W = F, Cl, and OH. For micas totalFe is assumed to be Fe2+. MinPlot also assumes a full W site (OH = 2 – F – Cl), which may not be accurate and thus provides an estimation of the maximum possibly OH content. Mica endmembers are calculated based on two compositional groups: 1. Dioctahedral muscovite (Xms), ferroceladonite (XFe-cel), magnesioceladonite (XMg-cel), paragonite (Xpg), margarite (Xmrg), and pyrophyllite (Xprl) species, or 2. Trioctahedral, phlogopite (Xphl), annite (Xann), eastonite (Xeas), and siderophyllite (Xsid) species. The total dioctahedral or trioctahedral components are given as XDiOct and XTriOct, respectively. Plots for micas include the 1. Xms, XAl-cel, and Xprl ternary diagram, 2. Celadonite and muscovite + paragonite solid solution diagram, 3. Na (APFU) vs. Si (APFU) diagram, 4. F-Cl-OH ternary , and 5. Trioctahedral Ann-Phl-Sid-East solid solution diagram.

<img width="700" alt="mica structural formula" src="https://user-images.githubusercontent.com/87534196/200600143-7a5ae6c7-7d7f-40f3-900b-d624f34f83ce.png">

Staurolite: Staurolite (A4B4C18D4T8O40X8) exhibits a complex formula with vacancies on multiple sites: A = Fe2+, Mg, and □, Fe2+, B = Zn, Co, Mg, Li, Al, Fe3+,Mn, and □, C = Al, Fe3+, Cr, V, Mg, and Ti, D = Al, Mg, and □, T = Si and Al, and X = OH, Cl, F, and O2- (Hawthorne et al., 1993). the composition space in MinPlot following formula recalculation is restricted to Li, Mg, Mn, Zn, Fe2+, Fe3+, Al, Ti, and Si. The user may select a ratio for Fe3+/totalFe before normalization. The values of 0.035 for ilmenite-bearing rocks (Xhem < 0.10) and 0.070 for hematite-ilmenite rocks (Xhem > 0.10) following Holdaway et al. (1991) are recommended. Normalization is conducted in two ways, 1. Assuming Si + Al = 25.53 APFU following Holdaway et al. (1991) and 2. Normalization to 48 oxygen equivalents. The total number of vacancies is then calculated as vac = 30 - cation total (Holdaway et al., 1991). Endmember calculation and plotting options are not currently available.

Cordierite: Cordierite (A0-1B2T23T16O18) is calculated here normalized to 18 moles of oxygen equivalents. Cations are assigned as A = Ca, Na, and K, B = Fe2+, Mn, and Mg, T2 = Al and Ti, and T1 = Si and Al. The fraction of magnesium (XMg) is calculated as Mg/(Mg+Fe). 

Chlorite: Chlorite (M6T4O10(OH)8) is normalized to 14 oxygen equivalents. Cations are assigned as M = Mg, Mn, Fe2+, Ni, Ti, and viAl at the octahedral site, whereas T = ivAl and Si at the tetrahedral site. Ferric iron is not considered. Vacancies on M1 are calculated as (viAl - ivAl)/2 following Lanari et al. (2014). Chlorite compositions are plotted in a diagram of VIAl vs XMg, which explores the compositional space between the clinochlore, chamosite, and sudoite endmembers.

Chloritoid: Chloritoid is made up of two octahedral layers, L1 and L2, linked by SiO4 tetrahedra, where L1 is (Na, Ca, Mg, Mn, Fe2+)2(Al,Ti,Fe3+)O2(OH)4, L2 is Al3O2, and the tetrahedral (T) site is 2[SiO4]. Here Fe3+ is estimated by charge balance criteria byy assuming 8 cations and 12 oxygens. Chloritoid compositions may be plotted as either a XMg binary (with adjustable upper and lower limits) or in the Fe2+-Mg-Mn ternary.

Talc: The structural formula for talc (M3T4O10(OH)2) is normalized here to 11 oxygen equivalents (anhydrous), with M = K, Na, Ca, Mg, Mn, Fe2+, Ni, Ti, and viAl allocated to the octahedral site, andT = ivAl and Si at the tetrahedral site. Here totalFe is assumed to be Fe2+. 

Epidote group: Compositions of epidote group members are described as (A2M3T3(O,OH,F)12), where A = K, Na, Ca, and Mg, M = Mn3+,Fe3+, Cr, Ti, and IVAl, and T = IVAl and Si. The most abundant epidote group minerals fall between the (clino-)zoisite (Ca2Al3Si3O11O(OH)) and epidote (Ca2Al2FeSi3O11O(OH)) endmembers. The exchange vectors with peimontite (Ca2Al2MnSi3O11O(OH)) and Cr-epidote (Ca2Al2CrSi3O11O(OH)) are also considered here. Normalization is based on a 12.5 oxygen equivalent (anhydrous) basis. Endmembers fractions are expressed as (clino-)zoisite (Xczo = (AlVI-2)/(Fe3+ + AlVI + Cr + Mn3+ - 2)), epidote (Xep = Fe3+/(Fe3+ + AlVI + Cr + Mn3+ - 2)), piemontite (Xpmt = Mn3+/(Fe3+ + AlVI + Cr + Mn3+ - 2)), and Cr-epidote (XCrep. = Cr/(Fe3+ + AlVI + Cr + Mn3+ - 2). Epidote compositions are plotted in an Al-Fe3+ binary diagram, like plots offered for olivineand chloritoid. 

<img width="500" alt="epidote" src="https://user-images.githubusercontent.com/87534196/200611352-8bd642df-3974-4897-9dc3-505b7d77bbb6.png">

Titanite: Titanite (CaTiSiO5) has three structural sites. The 7-fold decahedral site may incorporate K, Na, Y, and Ca, the octahedral site may incorporate Mg, Mn, Fe3+, Ti, and viAl, and the tetrahedral site contains Si and ivAl. Normalization assumes that the tetrahedral and octahedral sites sum to 2. Fluorine may be measured by directly EPMA; whereas, OH is calculated as OH = (AlVI + Fe3+) – F. Oxygen is calculated as the sum of the cation charges minus 0.5(F + OH).  The fraction of titanite (Xttn) is calculated as Ti/sum of the octahedral site.

Oxyspinel: Oxyspinel group minerals (AB2O4) are calculated here to 3 cations and 4 oxygen equivalents for Fe3+ estimation. Here A = Mg, Mn, Fe2+, Zn, and Ni are assigned at the tetrahedral (A) site, whereas B = Fe3+, Cr, Al, and Ti substitute at the octahedral (B) site. Oxyspinel compositions are plotted in the Cr, Fe3+ + 2Ti, and Al and Fe2+, Mg, and Mn + Zn + Ni ternary diagrams.

New!! Apatite: Apatite (M10(TO4)6Z2) is now available. Here M = La, Ce, Na, K, Sr, Ba, Ca, Mg, Mn, Fe2+, Al, and Ti, T = P, Si, S4+, and S6+, and Z = OH, F, Cl, S1-, and S2-. The formula recalculation on 25 oxygen equivalents on the anhydrous formula excluding S1-, S2-, F, and Cl following Ketcham (2015) in American Mineralogist is followed. My extensive testing show this method produced the correct results for synthetic apatite compositions when including S2-, whereas normalization on 26 oxygen equivalents - 0.5(F + Cl + S1-) - S2- did not produce accurate results. In this case there is no itteration to determine OH contents, which are simply calculated as 2 - (F + Cl + S1- + 2 * S2-). Assignment of sulfur species follows Sadove et al. (2019) in Ore Geology Reviews. If sulfur is analyzed the user can specify the sulfur speciation as follows: If the apatite has a ratio of 0.8 S6+, 0.1 S4+, 0.1 S1-, and 0.0 S2-, the sulfur speciation should be entered into the prompt as [0.8; 0.1; 0.1; 0.0], including brackets and semi colons in order for the vector to be properly recognized by Matlab. If the sulfur speciation is not known it could be assumed based on other criteria (S6+ is reasonable for apatite from very oxidized magmas, for example), but the oxidation state MUST be assigned. Plotting includes the Cl, F, OH ternary. Because most apatites will have Cl >> S1- + S2- and F >> S1- + S2-, the sulfur anions are grouped with OH in the diagram.

Important!! - Because the OH content is calculated by 2 - (F + Cl + S1- + 2 * S2-), it is possible to calculate negative OH contents. This is likely to occuur in fluoroapatite becauuse of F diffusion induced by the electron beam. I chose to not set a hard limit on the Z site and allow for negative OH values, this is an important check on the quality of the apatite analysis! Analysis with OH < 0 should be repeated with appropriate beam conditions (e.g. large spot size, low current, short counting times on F).

New!! Ilmenite: Ilmenite group minerals (A2O3) are calculated here to 2 cations and 3 oxygen equivalents for Fe3_ estimation. Here A = Fe2+, Fe3+, Mg, Mn, Cr, V, Ti, Si, and Ca. Si and Ca are primarily included as a monitor for mixed analysis with silicate phases. Endmembers are calculated for hematite (Fe2O3), ilmenite (FeTiO3), pyrophanite (MnTiO3), and geikilite (MgTiO3). The hematite component is calculated by XHem = Fe3+ / (Fe3+ / Ti) and the total ilmenite + pyrophanite + geikilite component is calculated by 1 - XHem. The remaining endmembers are calculated from the Fe2+/(Fe2+ + Mn + Mg) for ilmenite, Mn/(Fe2+ + Mn + Mg) for pyrophanite, and Mg/(Fe2+ + Mn + Mg) for geikilite. Currently no plotting option is available. 

Sulfides: A generic procedure is available for sulfide minerals. The datafile requires the mass fractions (in wt. %) for S, Co, Cu, As, Fe, Ni, Pb, and Zn. All elements, except for S, are optional, allowing the maximum flexibility for a variety of sulfides. Arsenic may be considered as a cation in its oxidized form or an anion in its reduced form. 
